{% trans_default_domain 'PequivenSEIPBundle' %}

{% set planningServices = [] %}
{% for plantReport in report_template.plantReports %}
    {% for consumerPlanningService in plantReport.consumerPlanningServices %}
        {% set planningServices = planningServices|merge([consumerPlanningService]) %}
    {% endfor %}
{% endfor %}

<div class="block">
    <div class="block-title">
        <h3> {{ 'Services'|trans }}&nbsp;({{ planningServices|length }})</h3>
    </div>
    <div class="with-padding">
        <table class="simple-table responsive-table tables-extras" id="sorting-example2">
            <thead>
                <tr>
                    <th scope="col" width="35%">{{ 'Service'|trans }}</th>
                    <th scope="col" width="10%" class="hide-on-mobile-portrait">{{ ''|trans }}</th>
                    <th scope="col" width="10%" class="hide-on-tablet">{{ 'Product unit'|trans }}</th>
                    <th scope="col" width="10%">&nbsp;</th>
                </tr>
            </thead>
            {% set colspan = 6 %}
            <tbody>
                {% for plantReport in report_template.plantReports %}
                    <tr>
                        <td class="text-center bold" colspan="{{ colspan }}">
                            {{ plantReport }}
                        </td>
                    </tr>
                        {% for consumerPlanningService in plantReport.consumerPlanningServices %}
                            <tr>
                                <td>{{ loop.index }} - 
                                    {{ generateLink(consumerPlanningService) }}
                                </td>
                                <th scope="row">

                                </th>
                                <td>{{ consumerPlanningService.service.serviceUnit }}</td>
                                <td class="low-padding align-center">
                                    <a href="{{ path("pequiven_consumer_planning_service_update",{id: consumerPlanningService.id}) }}" class="button compact icon-pencil">{{ "pequiven_seip.actions.edit"|trans }}</a>
                                </td>
                            </tr>
                        {% else %}
                            <tr >
                                <td colspan="{{ colspan }}" class="empty_row">
                                    {{ "empty.consumer_planning_services"|trans }}
                                </td>
                            </tr>
                        {% endfor %}
                {% endfor %}
            </tbody>
        </table>
        
    </div>
</div>